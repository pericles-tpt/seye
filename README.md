# Fiye
`Fiye` is a tool that allows you to create space-efficient "scans" of one or more directories.

## Information Gathered by Fiye
"Shallow" scans allow you to:
- get the largest files in a directory
- get the total size of a directory and the number of files within it
- get the change in disk usage of the target directory and its subdirectories between two points in time

"Comprehensive" scans provide additional data, including:
- the location of duplicates
- whether any files and/or directories have changed within the target directory, between two points in time 

## Shallow vs Comprehensive Scans
"Shallow" scans will collect information about directories and basic file information accessible with the `stat` system call, namely:
- file size
- last modified time

"Comprehensive" scans will collect the same information as "shallow" scans in addition to storing hashes (using the SHA256 algorithm) of any files that `Fiye` has permission to read.

## How it Works
When you run a `Fiye` `scan` on a specified directory it will traverse that directory and all its files and subdirectories. The initial scan is **always**, "comprehensive." As a result of this it may take significantly more time and disk space (when saved) than subsequent scans, depending on the number of files contained in the target directory and their size. 

Once `Fiye` has detected that the user has performed an initial scan for a given path, it will choose to perform either a "shallow" or "comprehensive" scan depending on the information the user wants to obtain, see [Information Generated by Fiye](#information-generated-by-fiye). 

In order to use the least disk space possible, `Fiye` only stores the:
- first full scan ("comprehensive")
- last full scan ("comprehensive" or "shallow")
- "diffs" of every scan between the first and last scans ("comprehensive" ONLY if the scans being "diff"ed are both "comprehensive")

This means for 'n' scans, the number of files generated are: 
$$1 * fullComprehensive + 1 * fullComprehensiveOrShallow + (n-1) * diffComprehensiveOrShallow$$

### Disk Usage
The amount of disk space used by `Fiye`, is dependent on a number of factors including:
- number of files in a target directory
  - how many files are non-empty 
- number of subdirectories in a target directory
- how many scans have been completed
- whether the last scan was "comprehensive"
- time between scans (i.e. higher -> more changes (maybe) -> larger diffs)
- if scans being "diff"ed are both "comprehensive" -> larger diff
- whether the last scan is comprehensve
- time between the first and last scan

#### *Rough* Disk Usage of Scans (bytes)
For a "shallow" scan the disk usage will be:
$$numDirectories * sizeOf(collectedDirectoryStats) + numFiles * sizeOf(collectedFileStats)$$ 
\
\
For a "comprehensive" scan its size will be:
$$sizeOf(shallowScan) + (numNonEmptyFiles * 32)$$
\
\
For a generated "diff", its size will be:
$$sizeOf(directoryDiff) * numDifferentDirectories + sizeOf(fileDiff) * numDifferentFiles$$
If the two scans being "diff"ed are both "comprehensive" the size of the diff increases by:
$$numNonEmptyDifferentFiles * 32$$

### Scan Flowchart
<p align="center">
  <img src="./seye_flowchart.svg" title="flowchart of how Fiye generates scans" width=35%>
</p>

## Limitations
`Fiye` is only able to get information and hash files that it has permission to access. Files and directories that are not accessible to the user will not be scanned by `Fiye`.
